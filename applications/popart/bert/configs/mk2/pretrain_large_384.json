{
    "task": "PRETRAINING",
    "num_layers": 24,
    "encoder_start_ipu": 0,
    "layers_per_ipu": [3, 7, 7, 7],
    "hidden_size": 1024,
    "attention_heads": 16,
    "sequence_length": 384,
    "mask_tokens": 56,
    "vocab_length": 30400,
    "popart_dtype": "FLOAT16",
    "no_dropout": false,
    "no_attn_dropout": true,
    "stochastic_rounding": true,
    "enable_half_partials": true,
    "batches_per_step":  1,
    "epochs": 2,
    "epochs_per_save": 1,
    "steps_per_log": 100,
    "aggregate_metrics_over_steps": 1,
    "loss_scaling": 64.0,
    "batch_size": 2,
    "gradient_accumulation_factor": 2048,
    "replication_factor": 4,
    "split_qkv": true,
    "optimizer_state_offchip": true,
    "gradient_reduction_type": "Mean",
    "optimizer": "LAMB_NO_BIAS",
    "beta1": 0.9,
    "beta2": 0.999,
    "weight_decay": 1e-2,
    "lr_schedule_by_step": {
        "0": 1e-07,
        "1": 1.0422361770072994e-05,
        "2": 2.0744723540145986e-05,
        "3": 3.1067085310218985e-05,
        "4": 4.138944708029198e-05,
        "5": 5.171180885036497e-05,
        "6": 6.203417062043797e-05,
        "7": 7.235653239051096e-05,
        "8": 8.267889416058395e-05,
        "9": 9.300125593065694e-05,
        "10": 0.00010332361770072993,
        "11": 0.00011364597947080293,
        "12": 0.00012396834124087593,
        "13": 0.00013429070301094892,
        "14": 0.00014461306478102192,
        "15": 0.0001549354265510949,
        "16": 0.0001652577883211679,
        "17": 0.0001755801500912409,
        "18": 0.00018590251186131388,
        "19": 0.00019622487363138688,
        "20": 0.00020654723540145987,
        "21": 0.00021686959717153289,
        "22": 0.00022719195894160585,
        "23": 0.00023751432071167884,
        "24": 0.00024783668248175186,
        "25": 0.00025815904425182485,
        "26": 0.00026848140602189785,
        "27": 0.00027880376779197084,
        "28": 0.00028912612956204383,
        "29": 0.0002994484913321168,
        "30": 0.0003097708531021898,
        "31": 0.0003200932148722628,
        "32": 0.0003304155766423358,
        "33": 0.0003407379384124088,
        "34": 0.0003510603001824818,
        "35": 0.0003613826619525548,
        "36": 0.00037170502372262776,
        "37": 0.00038202738549270076,
        "38": 0.00039234974726277375,
        "39": 0.00040267210903284674,
        "40": 0.00041299447080291973,
        "41": 0.0004233168325729928,
        "42": 0.00043363919434306577,
        "43": 0.0004439615561131387,
        "44": 0.0004542839178832117,
        "45": 0.0004646062796532847,
        "46": 0.0004749286414233577,
        "47": 0.00048525100319343073,
        "48": 0.0004955733649635037,
        "49": 0.0005058957267335767,
        "50": 0.0005162180885036497,
        "51": 0.0005265404502737226,
        "52": 0.0005368628120437956,
        "53": 0.0005471851738138686,
        "54": 0.0005575075355839416,
        "55": 0.0005678298973540146,
        "56": 0.0005781522591240876,
        "57": 0.0005884746208941606,
        "58": 0.0005987969826642336,
        "59": 0.0006091193444343066,
        "60": 0.0006194417062043796,
        "61": 0.0006297640679744526,
        "62": 0.0006400864297445256,
        "63": 0.0006504087915145985,
        "64": 0.0006607311532846715,
        "65": 0.0006710535150547445,
        "66": 0.0006813758768248175,
        "67": 0.0006916982385948905,
        "68": 0.0007020206003649635,
        "69": 0.0007123429621350366,
        "70": 0.0007226653239051096,
        "71": 0.0007329876856751825,
        "72": 0.0007433100474452555,
        "73": 0.0007536324092153285,
        "74": 0.0007639547709854015,
        "75": 0.0007742771327554744,
        "76": 0.0007845994945255474,
        "77": 0.0007949218562956204,
        "78": 0.0008052442180656934,
        "79": 0.0008155665798357664,
        "80": 0.0008258889416058394,
        "81": 0.0008362113033759125,
        "82": 0.0008465336651459855,
        "83": 0.0008568560269160585,
        "84": 0.0008671783886861315,
        "85": 0.0008775007504562044,
        "86": 0.0008878231122262774,
        "87": 0.0008981454739963503,
        "88": 0.0009084678357664233,
        "89": 0.0009187901975364963,
        "90": 0.0009291125593065693,
        "91": 0.0009394349210766423,
        "92": 0.0009497572828467153,
        "93": 0.0009600796446167883,
        "94": 0.0009704020063868614,
        "95": 0.0009807243681569345,
        "96": 0.0009910467299270075,
        "97": 0.0010013690916970805,
        "98": 0.0010116914534671535,
        "99": 0.0010220138152372265,
        "100": 0.0010323361770072995,
        "101": 0.0010426585387773725,
        "102": 0.0010529809005474454,
        "103": 0.0010633032623175184,
        "104": 0.0010736256240875914,
        "105": 0.0010839479858576642,
        "106": 0.0010942703476277374,
        "107": 0.0011045927093978104,
        "108": 0.0011149150711678834,
        "109": 0.0011252374329379564,
        "110": 0.0011355597947080294,
        "111": 0.0011458821564781024,
        "112": 0.0011562045182481754,
        "113": 0.0011665268800182484,
        "114": 0.0011768492417883213,
        "115": 0.0011871716035583943,
        "116": 0.0011974939653284673,
        "117": 0.0012078163270985403,
        "118": 0.0012181386888686133,
        "119": 0.0012284610506386863,
        "120": 0.0012387834124087593,
        "121": 0.0012491057741788323,
        "122": 0.0012594281359489053,
        "123": 0.0012697504977189783,
        "124": 0.0012800728594890513,
        "125": 0.0012903952212591243,
        "126": 0.0013007175830291972,
        "127": 0.0013110399447992702,
        "128": 0.0013213623065693432,
        "129": 0.0013316846683394162,
        "130": 0.0013420070301094892,
        "131": 0.0013523293918795622,
        "132": 0.0013626517536496352,
        "133": 0.0013729741154197082,
        "134": 0.0013832964771897812,
        "135": 0.0013936188389598542,
        "136": 0.0014039412007299272,
        "137": 0.0014142635625000002,
        "138": 0.0014245859242700734,
        "139": 0.0014349082860401461,
        "140": 0.0014452306478102194,
        "141": 0.0014555530095802921,
        "142": 0.0014658753713503651,
        "143": 0.0014761977331204381,
        "144": 0.001486520094890511,
        "145": 0.001496842456660584,
        "146": 0.001507164818430657,
        "147": 0.0015174871802007299,
        "148": 0.001527809541970803,
        "149": 0.0015381319037408758,
        "150": 0.001548454265510949,
        "151": 0.0015587766272810223,
        "152": 0.001569098989051095,
        "153": 0.0015794213508211682,
        "154": 0.001589743712591241,
        "155": 0.0016000660743613142,
        "156": 0.001610388436131387,
        "157": 0.00162071079790146,
        "158": 0.001631033159671533,
        "159": 0.001641355521441606,
        "160": 0.001651677883211679,
        "161": 0.001662000244981752,
        "162": 0.0016723226067518252,
        "163": 0.001682644968521898,
        "164": 0.0016929673302919712,
        "165": 0.001703289692062044,
        "166": 0.0017136120538321171,
        "167": 0.00172393441560219,
        "168": 0.0017342567773722631,
        "169": 0.001744579139142336,
        "170": 0.0017549015009124089,
        "171": 0.0017652238626824819,
        "172": 0.0017755462244525549,
        "173": 0.0017858685862226279,
        "174": 0.0017961909479927009,
        "175": 0.001806513309762774,
        "176": 0.0018168356715328468,
        "177": 0.00182715803330292,
        "178": 0.0018374803950729928,
        "179": 0.001847802756843066,
        "180": 0.0018581251186131388,
        "181": 0.001868447480383212,
        "182": 0.0018787698421532848,
        "183": 0.001889092203923358,
        "184": 0.0018994145656934308,
        "185": 0.0019097369274635038,
        "186": 0.0019200592892335768,
        "187": 0.0019303816510036498,
        "188": 0.001940704012773723,
        "189": 0.0019510263745437957,
        "190": 0.0019613487363138687,
        "191": 0.0019716710980839415,
        "192": 0.0019819934598540147,
        "193": 0.0019923158216240875,
        "194": 0.0020026381833941607,
        "195": 0.0020129605451642335,
        "196": 0.0020232829069343067,
        "197": 0.0020336052687043795,
        "198": 0.0020439276304744527,
        "199": 0.0020542499922445254,
        "200": 0.0020645723540145986,
        "201": 0.002074894715784672,
        "202": 0.0020852170775547446,
        "203": 0.0020955394393248174,
        "204": 0.0021058618010948906,
        "205": 0.0021161841628649634,
        "206": 0.0021265065246350366,
        "207": 0.0021368288864051094,
        "208": 0.0021471512481751826,
        "209": 0.0021574736099452554,
        "210": 0.002167795971715328,
        "211": 0.0021781183334854013,
        "212": 0.0021884406952554745,
        "213": 0.0021987630570255473,
        "214": 0.0022090854187956205,
        "215": 0.0022194077805656933,
        "216": 0.0022297301423357665,
        "217": 0.0022400525041058393,
        "218": 0.0022503748658759125,
        "219": 0.0022606972276459853,
        "220": 0.0022710195894160585,
        "221": 0.0022813419511861313,
        "222": 0.0022916643129562045,
        "223": 0.0023019866747262772,
        "224": 0.0023123090364963505,
        "225": 0.0023226313982664237,
        "226": 0.0023329537600364964,
        "227": 0.0023432761218065696,
        "228": 0.0023535984835766424,
        "229": 0.0023639208453467156,
        "230": 0.0023742432071167884,
        "231": 0.0023845655688868616,
        "232": 0.0023948879306569344,
        "233": 0.002405210292427007,
        "234": 0.0024155326541970804,
        "235": 0.002425855015967153,
        "236": 0.0024361773777372264,
        "237": 0.002446499739507299,
        "238": 0.0024568221012773723,
        "239": 0.002467144463047445,
        "240": 0.0024774668248175183,
        "241": 0.002487789186587591,
        "242": 0.0024981115483576643,
        "243": 0.002508433910127737,
        "244": 0.0025187562718978103,
        "245": 0.002529078633667883,
        "246": 0.0025394009954379563,
        "247": 0.002549723357208029,
        "248": 0.0025600457189781023,
        "249": 0.002570368080748175,
        "250": 0.0025806904425182482,
        "251": 0.0025910128042883214,
        "252": 0.0026013351660583942,
        "253": 0.0026116575278284674,
        "254": 0.00262197988959854,
        "255": 0.0026323022513686134,
        "256": 0.002642624613138686,
        "257": 0.0026529469749087594,
        "258": 0.002663269336678832,
        "259": 0.0026735916984489054,
        "260": 0.002683914060218978,
        "261": 0.002694236421989051,
        "262": 0.002704558783759124,
        "263": 0.002714881145529197,
        "264": 0.00272520350729927,
        "265": 0.002735525869069343,
        "266": 0.002745848230839416,
        "267": 0.002756170592609489,
        "268": 0.002766492954379562,
        "269": 0.002776815316149635,
        "270": 0.002787137677919708,
        "271": 0.002797460039689781,
        "272": 0.002807782401459854,
        "273": 0.002818104763229927,
    	"274": 0.002828427125,
        "282": 0.002816314375,
        "290": 0.002804201625,
        "298": 0.002792088875,
        "306": 0.002779976125,
        "314": 0.002767863375,
        "322": 0.002755750625,
        "330": 0.002743637875,
        "338": 0.002731525125,
        "346": 0.002719412375,
        "354": 0.002707299625,
        "362": 0.002695186875,
        "370": 0.002683074125,
        "378": 0.002670961375,
        "386": 0.0026588486250000002,
        "394": 0.002646735875,
        "402": 0.002634623125,
        "410": 0.002622510375,
        "418": 0.002610397625,
        "426": 0.002598284875,
        "434": 0.0025861721250000002,
        "442": 0.002574059375,
        "450": 0.002561946625,
        "458": 0.002549833875,
        "466": 0.002537721125,
        "474": 0.002525608375,
        "482": 0.002513495625,
        "490": 0.002501382875,
        "498": 0.002489270125,
        "506": 0.002477157375,
        "514": 0.002465044625,
        "522": 0.002452931875,
        "530": 0.002440819125,
        "538": 0.002428706375,
        "546": 0.002416593625,
        "554": 0.002404480875,
        "562": 0.002392368125,
        "570": 0.002380255375,
        "578": 0.002368142625,
        "586": 0.002356029875,
        "594": 0.002343917125,
        "602": 0.002331804375,
        "610": 0.002319691625,
        "618": 0.0023075788749999998,
        "626": 0.002295466125,
        "634": 0.002283353375,
        "642": 0.002271240625,
        "650": 0.002259127875,
        "658": 0.002247015125,
        "666": 0.0022349023750000002,
        "674": 0.002222789625,
        "682": 0.002210676875,
        "690": 0.002198564125,
        "698": 0.002186451375,
        "706": 0.002174338625,
        "714": 0.002162225875,
        "722": 0.002150113125,
        "730": 0.002138000375,
        "738": 0.002125887625,
        "746": 0.002113774875,
        "754": 0.0021016621249999997,
        "762": 0.0020895493750000002,
        "770": 0.002077436625,
        "778": 0.002065323875,
        "786": 0.002053211125,
        "794": 0.002041098375,
        "802": 0.002028985625,
        "810": 0.002016872875,
        "818": 0.002004760125,
        "826": 0.001992647375,
        "834": 0.001980534625,
        "842": 0.001968421875,
        "850": 0.0019563091249999998,
        "858": 0.001944196375,
        "866": 0.001932083625,
        "874": 0.001919970875,
        "882": 0.001907858125,
        "890": 0.0018957453750000001,
        "898": 0.0018836326249999998,
        "906": 0.0018715198749999998,
        "914": 0.001859407125,
        "922": 0.001847294375,
        "930": 0.001835181625,
        "938": 0.001823068875,
        "946": 0.001810956125,
        "954": 0.001798843375,
        "962": 0.001786730625,
        "970": 0.001774617875,
        "978": 0.0017625051249999999,
        "986": 0.001750392375,
        "994": 0.0017382796249999998,
        "1002": 0.0017261668749999999,
        "1010": 0.001714054125,
        "1018": 0.001701941375,
        "1026": 0.001689828625,
        "1034": 0.001677715875,
        "1042": 0.001665603125,
        "1050": 0.0016534903749999999,
        "1058": 0.001641377625,
        "1066": 0.001629264875,
        "1074": 0.0016171521249999999,
        "1082": 0.001605039375,
        "1090": 0.0015929266249999998,
        "1098": 0.001580813875,
        "1106": 0.001568701125,
        "1114": 0.0015565883749999998,
        "1122": 0.001544475625,
        "1130": 0.001532362875,
        "1138": 0.001520250125,
        "1146": 0.001508137375,
        "1154": 0.001496024625,
        "1162": 0.001483911875,
        "1170": 0.001471799125,
        "1178": 0.001459686375,
        "1186": 0.0014475736249999998,
        "1194": 0.001435460875,
        "1202": 0.001423348125,
        "1210": 0.0014112353749999999,
        "1218": 0.001399122625,
        "1226": 0.001387009875,
        "1234": 0.0013748971249999999,
        "1242": 0.001362784375,
        "1250": 0.001350671625,
        "1258": 0.001338558875,
        "1266": 0.001326446125,
        "1274": 0.0013143333749999998,
        "1282": 0.001302220625,
        "1290": 0.001290107875,
        "1298": 0.0012779951249999998,
        "1306": 0.001265882375,
        "1314": 0.001253769625,
        "1322": 0.0012416568749999998,
        "1330": 0.0012295441249999999,
        "1338": 0.001217431375,
        "1346": 0.0012053186249999998,
        "1354": 0.0011932058749999999,
        "1362": 0.001181093125,
        "1370": 0.001168980375,
        "1378": 0.001156867625,
        "1386": 0.0011447548749999998,
        "1394": 0.001132642125,
        "1402": 0.001120529375,
        "1410": 0.0011084166249999998,
        "1418": 0.001096303875,
        "1426": 0.001084191125,
        "1434": 0.0010720783749999998,
        "1442": 0.001059965625,
        "1450": 0.001047852875,
        "1458": 0.001035740125,
        "1466": 0.0010236273749999998,
        "1474": 0.001011514625,
        "1482": 0.000999401875,
        "1490": 0.0009872891249999999,
        "1498": 0.0009751763750000001,
        "1506": 0.000963063625,
        "1514": 0.0009509508749999999,
        "1522": 0.0009388381249999997,
        "1530": 0.000926725375,
        "1538": 0.0009146126249999999,
        "1546": 0.0009024998749999997,
        "1554": 0.000890387125,
        "1562": 0.0008782743749999999,
        "1570": 0.0008661616249999999,
        "1578": 0.0008540488749999996,
        "1586": 0.0008419361250000001,
        "1594": 0.0008298233749999997,
        "1602": 0.0008177106249999998,
        "1610": 0.0008055978749999999,
        "1618": 0.000793485125,
        "1626": 0.000781372375,
        "1634": 0.0007692596250000001,
        "1642": 0.0007571468749999997,
        "1650": 0.0007450341249999998,
        "1658": 0.0007329213749999999,
        "1666": 0.000720808625,
        "1674": 0.000708695875,
        "1682": 0.0006965831249999997,
        "1690": 0.0006844703750000002,
        "1698": 0.0006723576249999998,
        "1706": 0.0006602448749999999,
        "1714": 0.0006481321249999995,
        "1722": 0.0006360193750000001,
        "1730": 0.0006239066249999997,
        "1738": 0.0006117938749999998,
        "1746": 0.0005996811249999998,
        "1754": 0.0005875683749999999,
        "1762": 0.000575455625,
        "1770": 0.0005633428749999996,
        "1778": 0.0005512301250000001,
        "1786": 0.0005391173749999998,
        "1794": 0.0005270046249999999,
        "1802": 0.0005148918749999999,
        "1810": 0.000502779125,
        "1818": 0.0004906663749999996,
        "1826": 0.0004785536249999997,
        "1834": 0.0004664408749999998,
        "1842": 0.00045432812499999987,
        "1850": 0.00044221537499999995,
        "1858": 0.000430102625,
        "1866": 0.0004179898750000001,
        "1874": 0.00040587712499999973,
        "1882": 0.0003937643749999998,
        "1890": 0.0003816516249999999,
        "1898": 0.00036953887499999996,
        "1906": 0.0003574261249999996,
        "1914": 0.0003453133750000001,
        "1922": 0.00033320062499999975,
        "1930": 0.0003210878749999998,
        "1938": 0.0003089751249999999,
        "1946": 0.00029686237499999997,
        "1954": 0.0002847496249999996,
        "1962": 0.0002726368749999997,
        "1970": 0.00026052412499999976,
        "1978": 0.00024841137499999983,
        "1986": 0.0002362986249999999,
        "1994": 0.00022418587499999998,
        "2002": 0.00021207312500000006,
        "2010": 0.0001999603749999997,
        "2018": 0.00018784762499999977,
        "2026": 0.00017573487499999985,
        "2034": 0.00016362212499999992,
        "2042": 0.00015150937499999956,
        "2050": 0.00013939662500000007,
        "2058": 0.0001272838749999997,
        "2066": 0.00011517112499999978,
        "2074": 0.00010305837499999986,
        "2082": 9.094562499999993e-05,
        "2090": 7.883287500000001e-05,
        "2098": 6.672012499999965e-05,
        "2106": 5.4607375000000156e-05,
        "2114": 4.2494624999999796e-05,
        "2122": 3.038187499999987e-05,
        "2130": 1.8269124999999945e-05,
        "2138": 6.1563750000000195e-06
    },
    "input_files": [
        "data/wikipedia/AA/sequence_384/wiki_00_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_01_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_02_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_03_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_04_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_05_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_06_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_07_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_08_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_09_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_10_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_11_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_12_tokenised",
        "data/wikipedia/AA/sequence_384/wiki_13_tokenised"
    ],
    "shuffle": true,
    "duplication_factor": 6,
    "epochs_to_cache": 1,
    "embedding_serialization_vocab_steps": 5,
    "available_memory_proportion": [0.15, 0.28, 0.28, 0.28],
    "execution_mode": "PIPELINE",
    "checkpoint_dir": "checkpoints/mk2/pretrain_large",
    "no_validation": true
}
